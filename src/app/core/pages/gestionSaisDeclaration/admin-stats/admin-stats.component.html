<div class="dashboard-container" [class.loading]="loading">
  <div class="loader" *ngIf="loading">
    <div class="loader-spinner"></div>
    <div class="loader-text">Chargement des données...</div>
  </div>

  <h1 class="dashboard-title">
    <span>Tableau de bord administratif</span>
    <button class="refresh-btn" (click)="refreshData()">
      <i class="fas fa-sync-alt"></i>
    </button>
  </h1>

  <!-- Cartes principales -->
  <div class="stats-grid">
    <div class="stat-card orange-gradient">
      <div class="stat-icon">
        <i class="fas fa-file-alt"></i>
      </div>
      <div class="stat-content">
        <h3>Déclarations totales</h3>
        <div class="stat-value">{{ dashboardStats.totalDeclarations || 0 }}</div>
      </div>
    </div>

    <div class="stat-card green-gradient">
      <div class="stat-icon">
        <i class="fas fa-users"></i>
      </div>
      <div class="stat-content">
        <h3>Utilisateurs actifs</h3>
        <div class="stat-value">{{ dashboardStats.activeUsers || 0 }}</div>
      </div>
    </div>

    <div class="stat-card orange-gradient">
      <div class="stat-icon">
        <i class="fas fa-check-circle"></i>
      </div>
      <div class="stat-content">
        <h3>Taux de traitement</h3>
        <div class="stat-value">{{ dashboardStats.processRate || 0 }}%</div>
      </div>
    </div>

    <div class="stat-card green-gradient">
      <div class="stat-icon">
        <i class="fas fa-clock"></i>
      </div>
      <div class="stat-content">
        <h3>Temps moyen</h3>
        <div class="stat-value">{{ dashboardStats.avgProcessTime || 0 }} jours</div>
      </div>
    </div>
  </div>

  <!-- Graphiques -->
  <div class="charts-container">
    <div class="chart-card">
      <h2><i class="fas fa-chart-bar"></i> Activité des utilisateurs</h2>
      <div class="chart-wrapper">
        <canvas baseChart
          [data]="performanceChartData"
          [type]="performanceChartType"
          [options]="performanceChartOptions">
        </canvas>
      </div>
    </div>

    <div class="chart-card">
      <h2><i class="fas fa-chart-pie"></i> Statut des déclarations</h2>
      <div class="chart-wrapper">
        <canvas baseChart
          [data]="etatChartData"
          [type]="etatChartType"
          [options]="etatChartOptions">
        </canvas>
      </div>
    </div>

    <div class="chart-card full-width">
      <h2><i class="fas fa-chart-line"></i> Évolution mensuelle</h2>
      <div class="chart-wrapper">
        <canvas baseChart
          [data]="periodeChartData"
          [type]="periodeChartType"
          [options]="periodeChartOptions">
        </canvas>
      </div>
    </div>
  </div>

  <!-- Dernières activités -->
  <div class="activity-section" *ngIf="dashboardStats.recentActivity">
    <h2><i class="fas fa-history"></i> Dernières activités</h2>
    <div class="activity-list">
      <div class="activity-item" *ngFor="let activity of dashboardStats.recentActivity">
        <div class="activity-icon" [ngClass]="getActivityClass(activity.type)">
          <i [class]="getActivityIcon(activity.type)"></i>
        </div>
        <div class="activity-content">
          <div class="activity-title">{{ activity.description }}</div>
          <div class="activity-meta">
            <span class="activity-user">{{ activity.user }}</span>
            <span class="activity-time">{{ activity.time }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>